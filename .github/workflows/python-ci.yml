# 파일 경로: .github/workflows/download-security-regulations.yml

name: Download Security Regulations

on:
  # 매주 월요일 오전 2시에 자동실행
  schedule:
    - cron: '0 2 * * 1'
  # 수동 트리거 지원
  workflow_dispatch:

jobs:
  download-regulations:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Create regulations directory
        run: mkdir -p regulations

      - name: Download CVC regulations
        run: |
          curl -fsSL https://example.com/CVC_Regulations.pdf \
            -o regulations/CVC_Regulations_$(date +'%Y-%m-%d').pdf

      - name: Download CVE feed (NVD JSON)
        run: |
          curl -fsSL https://nvd.nist.gov/feeds/json/cve/1.1/nvdcve-1.1-modified.json.gz \
            -o regulations/CVE_Modified_$(date +'%Y-%m-%d').json.gz
          gunzip -f regulations/CVE_Modified_$(date +'%Y-%m-%d').json.gz

      - name: Download ISRM guidelines
        run: |
          curl -fsSL https://example.com/ISRM_Guidelines.pdf \
            -o regulations/ISRM_Guidelines_$(date +'%Y-%m-%d').pdf

      - name: Commit & push updates
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add regulations
          # 변경사항이 있을 때만 커밋
          git diff --quiet || git commit -m "chore: update CVC, CVE, ISRM regulations"
          git push
