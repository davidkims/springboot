name: ğŸ› ï¸ Workflow Syntax & Event Monitor

on:
  workflow_dispatch:
  schedule:
    - cron: '0 * * * *'  # ë§¤ ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰

jobs:
  validate-workflows:
    name: ğŸ” Validate all workflows in .github/workflows
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v4

      - name: ğŸ“ Find all workflow files
        id: find_workflows
        run: |
          echo "files=$(find .github/workflows -type f \( -iname '*.yml' -o -iname '*.yaml' \) -print0 | xargs -0)" >> $GITHUB_OUTPUT

      - name: ğŸ” Validate each workflow file
        run: |
          echo "ğŸ” GitHub Workflow Lint ì‹œì‘"
          success=true
          for file in ${{ steps.find_workflows.outputs.files }}; do
            echo "âš™ï¸ íŒŒì¼ ê²€ì‚¬ ì¤‘: $file"
            if ! act -j dummy -W "$file" --dryrun 2>&1 | tee tmp_result | grep -q 'Error'; then
              echo "âœ… $file: ìœ íš¨í•œ YAML"
            else
              echo "âŒ $file: ì˜¤ë¥˜ ë°œìƒ"
              success=false
              cat tmp_result
            fi
          done
          $success || exit 1
        env:
          ACT_LOG_LEVEL: debug

      - name: âœ… ë³´ê³ ì„œ ì¶œë ¥
        if: success()
        run: echo "âœ… ëª¨ë“  ì›Œí¬í”Œë¡œìš° íŒŒì¼ì´ ìœ íš¨í•©ë‹ˆë‹¤."

      - name: âš ï¸ ì˜¤ë¥˜ ë°œìƒ ì‹œ ê²½ê³ 
        if: failure()
        run: |
          echo "âŒ ì˜¤ë¥˜ê°€ ìˆëŠ” ì›Œí¬í”Œë¡œìš° íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ìˆ˜ì •ì´ í•„ìš”í•©ë‹ˆë‹¤."
