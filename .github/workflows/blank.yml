name: â˜• Java Auto-Transfer Transaction Workflow

on:
  push:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  auto-transfer:
    runs-on: ubuntu-latest

    env:
      MAVEN_VERSION: 3.9.6
      MAVEN_HOME: /opt/maven
      EXPORT_DIR: /opt/export
      BUILD_DIR: build-artifacts
      TIMESTAMP: ${{ github.run_id }}

    steps:
      - name: ğŸ“ ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4

      - name: ğŸ“¦ Maven ì„¤ì¹˜
        run: |
          wget https://dlcdn.apache.org/maven/maven-3/${MAVEN_VERSION}/binaries/apache-maven-${MAVEN_VERSION}-bin.tar.gz
          sudo tar -xzvf apache-maven-${MAVEN_VERSION}-bin.tar.gz -C /opt
          sudo mv /opt/apache-maven-${MAVEN_VERSION} $MAVEN_HOME
          echo "$MAVEN_HOME/bin" >> $GITHUB_PATH

      - name: ğŸ“‚ ìƒ˜í”Œ Java ì†ŒìŠ¤ì½”ë“œ ìë™ ìƒì„±
        run: |
          mkdir -p src/main/java/com/finance
          cat <<EOF > src/main/java/com/finance/TransactionRunner.java
package com.finance;

public class TransactionRunner {
  public static void main(String[] args) {
    System.out.println("ğŸ“‹ ìë™ ì´ì²´ ê±°ë˜ ìˆ˜í–‰ ì¤‘...");
    System.out.println("âœ… ì‹ ìš©ì¹´ë“œ ê±°ë˜: ì™„ë£Œ");
    System.out.println("âœ… ì²´í¬ì¹´ë“œ ê±°ë˜: ì™„ë£Œ");
    System.out.println("âœ… ì£¼ì‹ ë§¤ìˆ˜: ì™„ë£Œ");
    System.out.println("âœ… í™˜ìœ¨ ê±°ë˜: ì™„ë£Œ");
  }
}
EOF

      - name: ğŸ”¨ Maven ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸
        run: |
          /opt/maven/bin/mvn clean install -B

      - name: ğŸ“¦ JAR íŒŒì¼ ì¶”ì¶œ ë° ì €ì¥
        run: |
          mkdir -p $EXPORT_DIR $BUILD_DIR
          find . -type f -name "*.jar" -path "*/target/*.jar" -exec cp {} $EXPORT_DIR/ \;
          cp $EXPORT_DIR/*.jar $BUILD_DIR/
          echo "ğŸ“¦ Exported JARs:"
          ls -lh $BUILD_DIR

      - name: ğŸ“ ê±°ë˜ ë¡œê·¸ ì‹œë®¬ë ˆì´ì…˜
        run: |
          echo "$(date +'%F %T') ìë™ ì´ì²´ ê±°ë˜ ì™„ë£Œ" >> transaction.log
          cat transaction.log
