name: Install Java & Maven

on:
  workflow_dispatch:
  push:
    branches:
      - main

jobs:
  setup-java-maven:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Create install script
        run: |
          echo "📄 Creating scripts/install_java_maven.sh"
          mkdir -p scripts
          {
            echo '#!/usr/bin/env bash'
            echo 'set -euo pipefail'
            echo ''
            echo '# APT으로 OpenJDK 17과 Maven 설치'
            echo 'sudo apt-get update -y'
            echo 'sudo apt-get install -y openjdk-17-jdk maven'
            echo ''
            echo '# 설치 확인'
            echo 'java -version'
            echo 'mvn -version'
          } > scripts/install_java_maven.sh
          chmod +x scripts/install_java_maven.sh

      - name: Run install script
        run: ./scripts/install_java_maven.sh
