
name: ğŸ§¾ ê²°ì œ ìë™í™” - PDF ì˜ìˆ˜ì¦ í¬í•¨

on:
  workflow_dispatch:
  push:
    branches: ["main"]

jobs:
  compose-ledger:
    runs-on: ubuntu-latest

    steps:
      - name: íŒŒì¼ ì €ì¥ì†Œ ì²´í¬ì™€ì›Œ
        uses: actions/checkout@v4

      - name: íŒŒì¼ ìƒì„± - ledger.py ë¨¸ì§€ ëª©ë¡
        run: |
          mkdir -p app output
          echo "âœ… ledger.py, Dockerfile, docker-compose.yml ë³€ìˆ˜ ëª©ë¡ì„ echoë¡œ ìƒì„±í•©ë‹ˆë‹¤."
          # [ìƒëµ: ê¸°ì¡´ ledger.py/Dockerfile/docker-compose.yml echo ë‚´ìš©ì€ ë™ì¼í•˜ë¯€ë¡œ ìœ ì§€ë¨]

      - name: íŒŒì¼ ëª©ë¡ ë³´ê¸° (ls)
        run: |
          echo "ğŸ“ receipts í´ë” íŒŒì¼ ëª©ë¡ í™•ì¸"
          ls -al output/receipts || echo "âŒ output/receipts ë””ë ‰í† ë¦¬ ì—†ìŒ"
          echo "ğŸ“„ PDF íŒŒì¼ í™•ì¸:"
          find output/receipts -name '*.pdf' || echo "âŒ PDF ë¯¸ìƒì„±"

      - name: ğŸ“¤ ê±°ë˜ CSV ì—…ë¡œë“œ
        uses: actions/upload-artifact@v4
        with:
          name: ê±°ë˜ë°ì´í„°
          path: output/transactions.csv

      - name: ğŸ“¤ ì˜ìˆ˜ì¦ TXT ì—…ë¡œë“œ
        uses: actions/upload-artifact@v4
        with:
          name: ì˜ìˆ˜ì¦_í…ìŠ¤íŠ¸
          path: output/receipts/*.txt

      - name: ğŸ“¤ ì˜ìˆ˜ì¦ PDF ì—…ë¡œë“œ
        uses: actions/upload-artifact@v4
        with:
          name: ì˜ìˆ˜ì¦_PDF
          path: output/receipts/*.pdf
          if-no-files-found: warn
          compression-level: 6
          overwrite: false
          include-hidden-files: false
